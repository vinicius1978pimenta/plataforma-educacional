<div class="navbar-fake">
  <div class="navbar-title">
    <i class="fas fa-comments navbar-icon"></i> Chat
  </div>
  <button [routerLink]="'/dashboard-professor'" class="back-btn">
    <i class="fas fa-arrow-left"></i> Voltar
  </button>
</div>
<div class="chat-container">
  <!-- Seleção de Usuário -->
  <div class="user-selection" *ngIf="!currentUser">
    <div class="user-card">
      <h2>Bem-vindo(a) ao Chat!</h2>
      <p>Converse diretamente com o professor responsável pelo seu filho(a).</p>
      <div class="user-buttons">
        <button 
          class="user-btn responsavel" 
          (click)="selectUser('responsavel')"
        >
          👨‍👩‍👧‍👦 Entrar como Responsável
        </button>
      </div>
      <div class="welcome-emoji">
        
      </div>
    </div>
  </div>

  <!-- Interface do Chat -->
  <div class="chat-interface" *ngIf="currentUser">
    <!-- Header do Chat -->
    <div class="chat-header">
      <div class="user-info">
        <span class="user-avatar">{{ getUserAvatar(currentUser.type) }}</span>
        <div>
          <strong>{{ currentUser.name }}</strong>
          <small>({{ getUserTypeLabel(currentUser.type) }})</small>
        </div>
      </div>
      <div class="channel-info">
        <select class="channel-select" [(ngModel)]="selectedChannel" (change)="onChannelChange()">
          <option value="">Selecionar conversa...</option>
          <option 
            *ngFor="let channel of getAvailableChannels()" 
            [value]="channel.id"
          >
            {{ channel.name }}
          </option>
        </select>
      </div>
      <button class="logout-btn" (click)="logout()">Sair</button>
    </div>

    <!-- Área de Mensagens -->
    <div class="messages-container" #messagesContainer>
      <div class="message-info" *ngIf="!selectedChannel">
        <p>Selecione uma conversa para começar 📩</p>
      </div>
      
      <div class="message" 
           *ngFor="let message of messages" 
           [class.own-message]="message.senderId === currentUser.id"
           [class.other-message]="message.senderId !== currentUser.id">
        <div class="message-header">
          <span class="sender-avatar">{{ getUserAvatar(message.senderType) }}</span>
          <span class="sender-name">{{ message.senderName }}</span>
          <span class="message-time">{{ formatTime(message.timestamp) }}</span>
        </div>
        <div class="message-content">{{ message.content }}</div>
      </div>
    </div>

    <!-- Input de Mensagem -->
    <div class="message-input-container" *ngIf="selectedChannel">
      <div class="input-wrapper">
        <input 
          type="text" 
          class="message-input"
          [(ngModel)]="newMessage"
          (keyup.enter)="sendMessage()"
          placeholder="Digite sua mensagem..."
          maxlength="500"
        >
        <button 
          class="send-btn" 
          (click)="sendMessage()"
          [disabled]="!newMessage.trim()"
        >
          ➤
        </button>
      </div>
    </div>
  </div>
</div>
